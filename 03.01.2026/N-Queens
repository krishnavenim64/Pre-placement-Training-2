def solveNQueens(n):
    def backtrack(row, diagonals, antiDiagonals, cols, board):
        if row == n:
            res.append(["".join(r) for r in board])
            return
        
        for col in range(n):
            diag = row - col
            antiDiag = row + col
            if col in cols or diag in diagonals or antiDiag in antiDiagonals:
                continue
            
            cols.add(col)
            diagonals.add(diag)
            antiDiagonals.add(antiDiag)
            board[row][col] = 'Q'
            
            backtrack(row+1, diagonals, antiDiagonals, cols, board)
            
            cols.remove(col)
            diagonals.remove(diag)
            antiDiagonals.remove(antiDiag)
            board[row][col] = '.'
    
    res = []
    board = [["."]*n for _ in range(n)]
    backtrack(0, set(), set(), set(), board)
    return res

print(solveNQueens(4))
